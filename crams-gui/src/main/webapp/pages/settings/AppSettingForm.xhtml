<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/pages/freyatemplate/template.xhtml">

    <ui:define name="content">
        <div class="ui-g ui-fluid">
            <div class="ui-g-12">
                <ui:fragment rendered="#{!componentRenderer.administrator}">
                    <div class="ui-g ui-fluid">
                        <div class="ui-g-12">
                            <div class="exception-topbar">

                            </div>

                            <div class="exception-panel">

                                <h1 class="exception-summary">Access Denied</h1>
                                <p class="exception-detail">
                                    You don't have the necessary permissions.<br></br> Contact the
                                    administrator for more information.
                                </p>
                            </div>

                        </div>
                    </div>
                </ui:fragment>

                <ui:fragment rendered="#{componentRenderer.administrator}">
                    <h:form id="settingsForm">
                        <div class="card card-w-title" >

                            <h4>Adjust system settings</h4>


                        </div>

                        <div class="card card-w-title" >
                            <div class="p-grid p-justify-end">
                                <div class="p-col-1">
                                    <p:commandButton icon="fa fa-save" value="Save" id="saveBtn"
                                                     process=":settingsForm:tab:mailSetting 
                                                     :settingsForm:tab:generalSetting @this" 
                                                     styleClass="primary-button" validateClient="true"
                                                     action="#{settingsForm.save()}"
                                                     update=":settingsForm" />
                                </div>

                                <div class="p-col-1">
                                    <p:button value="Back" styleClass="help-button"
                                              icon="fa fa-backward" 
                                              outcome="/pages/dashboard/Dashboard" />
                                </div>
                            </div>

                            <p:tabView id="tab">
                                  <p:tab id="generalSetting" title="General">
                                    <div  class="p-grid ui-fluid">
                                        <div class="p-col-12 p-md-12 p-lg-6">

                                            <h:outputLabel for="sm" value="System name" />

                                            <p:inputText id="sm" value="#{settingsForm.model.systemName}" required="true" />

                                        </div>
                                        <div class="p-col-12 p-md-12 p-lg-6">

                                            <h:outputLabel for="tn" value="Theme name" />

                                            <p:inputText id="tn" value="#{settingsForm.model.systemName}" required="true" />

                                        </div>
                                        
                                        <div class="p-col-12 p-md-12 p-lg-6">

                                            <h:outputLabel for="ddp" value="Decimal places" />

                                            <p:inputText id="ddp" value="#{settingsForm.model.defaultCurrencyDecimalPlaces}" required="true" />

                                        </div>
                                        
                                          <div class="p-col-12 p-md-12 p-lg-6">

                                            <h:outputLabel for="dcc" value="Currency code" />

                                            <p:inputText id="dcc" value="#{settingsForm.model.defaultCurrencyCode}" required="true" />

                                        </div>

                                    </div>
                                </p:tab>
                                <p:tab id="mailSetting"  title="Mail Setting">
                                    <div  class="p-grid">
                                        <div class="p-col-12 p-md-12 p-lg-6">
                                            <p:outputLabel for="smtpHost">SMTP host</p:outputLabel>
                                            <p:inputText id="smtpHost"
                                                         value="#{settingsForm.model.mailSenderSmtpHost}"
                                                         required="true" placeholder="Enter sender SMTP host" />
                                        </div>
                                        <div class="p-col-12 p-md-12 p-lg-6">
                                            <p:outputLabel for="smtpPort">SMTP port</p:outputLabel>
                                            <p:inputText id="smtpPort"
                                                         value="#{settingsForm.model.mailSenderSmtpPort}"
                                                         required="true" placeholder="Enter sender SMTP port" />
                                        </div>
                                        <div class="p-col-12 p-md-12 p-lg-6">
                                            <p:outputLabel for="senderEmail">Sender email</p:outputLabel>
                                            <p:inputText id="senderEmail"
                                                         value="#{settingsForm.model.mailSenderAddress}"
                                                         required="true" placeholder="Enter sender email address" />
                                        </div>
                                        <div class="p-col-12 p-md-12 p-lg-6">
                                            <p:outputLabel for="senderPassword">Email password</p:outputLabel>
                                            <p:inputText id="senderPassword"
                                                         value="#{settingsForm.model.mailSenderPassword}"
                                                         required="true" placeholder="Enter sender email password" />
                                        </div>
                                       

                                    </div>
                                </p:tab>


                               

                              


                            </p:tabView>


                        </div>


                        <p:dialog widgetVar="test_email_dialog" style="max-width: 800px"
                                  height="300px" width="80%" header="Send test email" minHeight="40"
                                  responsive="true" showEffect="fade" modal="true">
                            <p:outputPanel id="testEmailForm">
                                <p:outputPanel 
                                    styleClass="p-grid ui-fluid">

                                    <div class="p-field ui-g-12 ui-md-12">
                                        <p:outputLabel for="testemail">Email</p:outputLabel>
                                        <p:inputText id="testemail" type="email"  value="#{settingsForm.testEmail}"
                                                     required="true" />
                                    </div>

                                    <div class="p-field ui-g-12 ui-md-12">
                                        <p:outputLabel for="testTitle">Test message</p:outputLabel>
                                        <p:inputTextarea id="testTitle" maxlength="100" value="#{settingsForm.testMessage}"
                                                         required="true" />
                                    </div>




                                </p:outputPanel>

                            </p:outputPanel>

                            <f:facet name="footer">

                                <p:commandButton value="Send" icon="pi pi-check"
                                                 actionListener="#{settingsForm.sendTestEmail()}" oncomplete="PF('test_email_dialog').hide()"
                                                 update="settingsForm" process="testEmailForm @this" />

                            </f:facet>


                        </p:dialog>
                        <p:blockUI block="settingsForm" trigger="saveBtn">
                            <p:graphicImage value="/resources/images/workingicon.png" />
                        </p:blockUI>

                    </h:form>
                </ui:fragment>
            </div>

        </div>
    </ui:define>
</ui:composition>